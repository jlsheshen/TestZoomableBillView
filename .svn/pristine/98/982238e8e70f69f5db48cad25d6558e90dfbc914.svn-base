package com.edu.testbill.billview.view;

import android.content.Context;
import android.widget.ImageView;

import com.edu.testbill.billview.ElementLayoutParams;
import com.edu.testbill.billview.IScaleable;
import com.edu.testbill.billview.ScaleUtil;
import com.edu.testbill.billview.data.SignData;

/**
 * 印章视图,支持缩放
 * 
 * @author lucher
 * 
 */
public class SignView extends ImageView implements IScaleable {

	private static final String TAG = "SignView";
	// 对应印章的信息
	private SignData mData;

	public SignView(Context context) {
		super(context);
		setScaleType(ScaleType.FIT_XY);
	}

	/**
	 * 设置印章对应数据，并把数据应用到该印章上
	 * 
	 * @param data
	 *            数据
	 * @param scale
	 *            缩放比例
	 * @return 印章是否合法
	 */
	public boolean apply(SignData data, float scale) {
		mData = data;
		if (data.getBitmap() == null) {
			return false;
		}
		setImageBitmap(data.getBitmap());
		postScale(scale, 0);
		
		return true;
	}

	@Override
	public void postScale(float scale, int scaleTimes) {
		// 布局参数缩放
		int scaledX = ScaleUtil.getScaledValue(mData.getX(), scale);
		int scaledY = ScaleUtil.getScaledValue(mData.getY(), scale);
		int scaledWidth = ScaleUtil.getScaledValue(mData.getWidth(), scale);
		int scaledHeight = ScaleUtil.getScaledValue(mData.getHeight(), scale);
		setLayoutParams(new ElementLayoutParams(mData.getType(), scaledX, scaledY, scaledWidth, scaledHeight));
	}

}
